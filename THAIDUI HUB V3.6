--========================================================--
--==============  THAIDUI HUB V3.7 ‚Äì FIX L·ªñI UI  =========--
--========================================================--

local HeartIcon = "rbxassetid://3926305904" 
local UserInputService = game:GetService("UserInputService")
local Library
local Window

-- =======================================
-- T·∫£i UI Library (S·ª¨A L·ªñI: S·ª≠ d·ª•ng m·ªôt li√™n k·∫øt ·ªïn ƒë·ªãnh h∆°n)
-- *T√¥i s·∫Ω d√πng m·ªôt phi√™n b·∫£n th∆∞ vi·ªán UI kh√°c t∆∞∆°ng th√≠ch (v√≠ d·ª•: T√≠n hi·ªáu Sentinel/Krnl UI)
-- =======================================
local libraryLink = "https://raw.githubusercontent.com/wally-rblx/vape/main/v4/source.lua" -- Link c≈© ƒë√£ l·ªói
local stableLink = "https://raw.githubusercontent.com/Green-Scripts/Sentinel-UI-Library/main/Source.lua" -- D√πng link thay th·∫ø

local success, err = pcall(function()
    -- Th·ª≠ t·∫£i th∆∞ vi·ªán UI m·ªõi/·ªïn ƒë·ªãnh
    Library = loadstring(game:HttpGet(stableLink))()
end)

if not success or not Library then
    -- N·∫øu v·∫´n l·ªói, b√°o l·ªói v√† d·ª´ng
    warn("üî¥ [THAIDUI ERROR] KH√îNG TH·ªÇ T·∫¢I UI LIBRARY. L·ªói: " .. tostring(err))
    return
end

-- T·∫°o Window
-- L∆∞u √Ω: T√™n h√†m kh·ªüi t·∫°o c√≥ th·ªÉ kh√°c nhau t√πy th∆∞ vi·ªán (Vape V4 l√† Load, Sentinel l√† Create)
-- T√¥i s·∫Ω gi·∫£ ƒë·ªãnh n√≥ v·∫´n l√† Load() ho·∫∑c t∆∞∆°ng t·ª± ƒë·ªÉ gi·ªØ c·∫•u tr√∫c
if Library.Load then
    Window = Library:Load(
        "‚ù§Ô∏è THAIDUI HUB V3.7 ‚ù§Ô∏è", 
        false -- Disable drag-bar
    )
elseif Library.Create then
    Window = Library:Create("‚ù§Ô∏è THAIDUI HUB V3.7 ‚ù§Ô∏è")
end

if not Window then
    warn("üî¥ [THAIDUI ERROR] Kh√¥ng th·ªÉ kh·ªüi t·∫°o Window t·ª´ Library ƒë√£ t·∫£i.")
    return
end

-- Th√™m ch·ª©c nƒÉng Toggle b·∫±ng ph√≠m K
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end
    if input.KeyCode == Enum.KeyCode.K then
        -- Toggle tr·∫°ng th√°i hi·ªÉn th·ªã c·ªßa Window ch√≠nh
        if Window.Toggle then
            Window.Toggle()
        else
            -- M·ªôt s·ªë th∆∞ vi·ªán kh√¥ng c√≥ h√†m Toggle(), ph·∫£i t·ª± x·ª≠ l√Ω Visible
            Window.Main.Visible = not Window.Main.Visible 
        end
    end
end)

--=============== DANH S√ÅCH SCRIPT ===============--
-- (Gi·ªØ nguy√™n nh∆∞ V3.6)

local scripts = {
    ["Blox Fruits"] = {
        ["Gravity Hub"] = "https://raw.githubusercontent.com/Dev-GravityHub/BloxFruit/refs/heads/main/Main.lua",
        ["W-Azure"] = "https://api.luarmor.net/files/v3/loaders/85e904ae1ff30824c1aa007fc7324f8f.lua",
        ["BlueX Hub"] = "https://raw.githubusercontent.com/Dev-BlueX/BlueX-Hub/refs/heads/main/Main.lua",
        ["Master Hub"] = "https://raw.githubusercontent.com/KiddoHiru/BloxFruits/main/MasterHub.lua",
        ["Mukuro Hub"] = "https://raw.githubusercontent.com/xQuartyx/MukuroHub/main/BloxFruit",
        ["Redz Hub"] = "https://raw.githubusercontent.com/RedzHubs/RedzScripts/main/BloxFruit.lua",
        ["Void Hub"] = "https://raw.githubusercontent.com/VoidMasterScript/VoidHub/main/Loader.lua",
        ["Neva Hub"] = "https://raw.githubusercontent.com/NevaHubDEV/Loader/main/NevaBF.lua",
        ["Fusion Hub"] = "https://raw.githubusercontent.com/FusionHubDev/Fusion/main/BloxFruit.lua",
        ["Delta Hub"] = "https://raw.githubusercontent.com/DeltaXHub/DeltaHub/main/BloxFruit.lua",
        ["Sakura Hub"] = "https://raw.githubusercontent.com/SakuraScripts/Loader/main/SakuraBF.lua",
        ["Astral Hub"] = "https://raw.githubusercontent.com/Overgustx2/Main/refs/heads/main/BloxFruits_25.html",
        ["Teddy Hub"] = "https://raw.githubusercontent.com/Teddyseetink/Haidepzai/refs/heads/main/TeddyHub.lua",
        ["Kaitun Script"] = "https://raw.githubusercontent.com/shinichi-dz/phucshinsayhi/refs/heads/main/KaitunBloxFruit.lua",
        ["Server VIP"] = "https://raw.githubusercontent.com/anuragaming1/Meow_gaming/refs/heads/main/Servervip.lua.txt",
        ["Ng·ªçc B·ªïng"] = "https://raw.githubusercontent.com/ngocbonggaming/script/refs/heads/main/NgocBongVn.lua",
        ["Quantum Hub"] = "https://raw.githubusercontent.com/flazhy/QuantumOnyx/refs/heads/main/QuantumOnyx.lua",
        ["TyBoy"] = "https://raw.githubusercontent.com/TBoyRoblox727/TBoyRobloxYTB/refs/heads/main/AllScriptBF.txt",
        ["H√≥d Server"] = "https://github.com/WhiteX1208/Scripts/blob/main/HopScript.luau?raw=true"
    },

    ["Plants vs Brainrots"] = {
        ["Speed Hub"] = "https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua",
        ["PvB Cheat"] = "https://pastebin.com/raw/pTfC8t7m", 
        ["Mega Farm"] = "https://raw.githubusercontent.com/test/Pvb/main/Farm.lua" 
    },

    ["C∆∞·ªõp 1 Brainrots"] = {
        ["Luin L·ªõn"] = "http://luminon.top/loader.lua",
        ["Luin Nh·ªè"] = "http://luminon.top/mini.lua",
        ["Vietnam Hub"] = "https://raw.githubusercontent.com/replit8173/VietnamHub/refs/heads/main/VietnamseHub.lua",
        ["Theft Hub"] = "https://raw.githubusercontent.com/TheftHub/Loader/main/Loader.lua" 
    }
}

--=============== T·∫†O C√ÅC TAB SCRIPT ===============--

for Name, List in pairs(scripts) do
    -- Th·ª≠ nghi·ªám c·∫£ hai h√†m NewTab/AddTab v√¨ th∆∞ vi·ªán c√≥ th·ªÉ kh√°c
    local Tab
    if Window.NewTab then
        Tab = Window:NewTab(Name)
    elseif Window.AddTab then
        Tab = Window:AddTab(Name)
    end
    
    if Tab and Tab.NewGroup then
        local Group = Tab:NewGroup(Name) 

        for BtnName, Link in pairs(List) do
            if Group.NewButton then
                Group:NewButton(BtnName, function()
                    -- Ch·ªâ th√¥ng b√°o n·∫øu h√†m Notify t·ªìn t·∫°i
                    if Window.Notify then
                        Window:Notify("Running: " .. BtnName, 3) 
                    end
                    loadstring(game:HttpGet(Link))()
                end)
            end
        end
    end
end

--========================================================--
--===================  TAB C√ÄI ƒê·∫∂T  ======================--
--========================================================--

local SettingsTab
if Window.NewTab then
    SettingsTab = Window:NewTab("C√†i ƒê·∫∑t")
elseif Window.AddTab then
    SettingsTab = Window:AddTab("C√†i ƒê·∫∑t")
end


if SettingsTab and SettingsTab.NewGroup then
    local CustomGroup = SettingsTab:NewGroup("Customization")

    -- Ch·ª©c nƒÉng Toggle Menu b·∫±ng ph√≠m K (Nh·∫Øc nh·ªü ng∆∞·ªùi d√πng)
    if CustomGroup.NewButton and Window.Notify then
        CustomGroup:NewButton("Toggle Menu (Ph√≠m K)", function()
            Window:Notify("S·ª≠ d·ª•ng ph√≠m 'K' ƒë·ªÉ ·∫©n/hi·ªán menu.", 5) 
        end)
    end

    -- 1. Ch·ª©c nƒÉng t√πy ch·ªânh ƒê·ªô trong su·ªët (Transparency)
    if CustomGroup.NewSlider and Window.SetTransparency then
        CustomGroup:NewSlider("ƒê·ªô Trong Su·ªët UI", 
            0,   
            1,   
            function(value)
                Window:SetTransparency(value) 
            end,
            0.1, 
            0.1 -- Gi√° tr·ªã m·∫∑c ƒë·ªãnh
        )
    end

    -- 2. Ch·ª©c nƒÉng t√πy ch·ªânh M√†u s·∫Øc (Theme Color)
    if CustomGroup.NewColorPicker and Window.SetTheme then
        CustomGroup:NewColorPicker("M√†u Ch·ªß ƒê·ªÅ", Color3.fromRGB(150, 0, 200), function(color)
            Window:SetTheme(color)
        end)
    end
end


--========================================================--
--==============  TAB TH√îNG S·ªê NG∆Ø·ªúI CH∆†I  ===============--
--========================================================--

-- Ph·∫ßn Stats HUD kh√¥ng ph·ª• thu·ªôc v√†o UI Library, n√™n gi·ªØ nguy√™n logic

local PlayerTab
if Window.NewTab then
    PlayerTab = Window:NewTab("Th√¥ng S·ªë Ng∆∞·ªùi Ch∆°i")
elseif Window.AddTab then
    PlayerTab = Window:AddTab("Th√¥ng S·ªë Ng∆∞·ªùi Ch∆°i")
end


if PlayerTab and PlayerTab.NewGroup then
    local StatsGroup = PlayerTab:NewGroup("Player Stats")

    local statsOn = false
    local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
    ScreenGui.Name = "THAIDUI_Stats_HUD"
    local StatsFrame = Instance.new("Frame", ScreenGui)
    local Text = Instance.new("TextLabel", StatsFrame)

    -- C·∫•u h√¨nh Frame
    StatsFrame.Size = UDim2.new(0, 240, 0, 140)
    StatsFrame.Position = UDim2.new(0.70, 0, 0.05, 0)
    StatsFrame.BackgroundTransparency = 0.2
    StatsFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    StatsFrame.Visible = false
    StatsFrame.Active = true
    StatsFrame.Draggable = true
    StatsFrame.BorderSizePixel = 0

    -- C·∫•u h√¨nh Text
    Text.Size = UDim2.new(1, 0, 1, 0)
    Text.BackgroundTransparency = 1
    Text.TextColor3 = Color3.fromRGB(255, 255, 255)
    Text.Font = Enum.Font.Code
    Text.TextSize = 12
    Text.TextXAlignment = Enum.TextXAlignment.Left
    Text.TextYAlignment = Enum.TextYAlignment.Top

    if StatsGroup.NewToggle then
        StatsGroup:NewToggle("B·∫≠t/T·∫Øt Th√¥ng S·ªë", function(state)
            statsOn = state
            StatsFrame.Visible = state
        end)
    end

    -- T·ªëi ∆∞u h√≥a FPS Counter (ƒêo d·ª±a tr√™n th·ªùi gian th·ª±c)
    local fps = 0
    local lastUpdate = tick()
    local frameCount = 0

    game:GetService("RunService").RenderStepped:Connect(function()
        frameCount = frameCount + 1
        local now = tick()
        local elapsed = now - lastUpdate
        
        if elapsed >= 1 then
            fps = math.floor(frameCount / elapsed)
            frameCount = 0
            lastUpdate = now
        end
    end)

    -- C·∫≠p nh·∫≠t th·ªëng s·ªë m·ªói 0.1s
    task.spawn(function()
        local Players = game:GetService("Players")
        while task.wait(0.1) do
            if statsOn and Players.LocalPlayer then
                local plr = Players.LocalPlayer
                local char = plr.Character 
                local hrp = char and char:FindFirstChild("HumanoidRootPart")
                local hum = char and char:FindFirstChild("Humanoid")
                
                local ping = 0
                if game:GetService("Stats") and game:GetService("Stats").Network.ServerStatsItem["Data Ping"] then
                    ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue() or 0
                end

                local posText = "N/A"
                if hrp then
                    posText = string.format("%.2f, %.2f, %.2f", hrp.Position.X, hrp.Position.Y, hrp.Position.Z)
                end

                Text.Text = string.format(
                    "‚ù§Ô∏è THAIDUI Stats ‚ù§Ô∏è\n" ..
                    "WalkSpeed: %.0f\nJumpPower: %.0f\nHealth: %.0f\nFPS: %s\nPing: %s ms\nX/Y/Z: %s",
                    hum and hum.WalkSpeed or 0,
                    hum and hum.JumpPower or 0,
                    hum and math.floor(hum.Health) or 0,
                    fps,
                    ping,
                    posText
                )
            end
        end
    end)
end
